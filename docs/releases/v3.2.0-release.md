# kctsb v3.2.0 Release Notes

> **Release Date**: 2026-01-13 (Beijing Time, UTC+8)  
> **Version**: 3.2.0  
> **Codename**: "Quantum Shield"

---

## ğŸ¯ Release Highlights

This release combines the planned v3.2.0 and v4.0.0 roadmap features into a single major update, delivering comprehensive post-quantum cryptography support, hardware acceleration, and zero-knowledge proof capabilities.

### Key Changes

1. **Post-Quantum Cryptography** - Kyber KEM and Dilithium signatures (NIST FIPS 203/204)
2. **Zero-Knowledge Proofs** - Groth16 zk-SNARK implementation on BN254
3. **SIMD Optimization** - AVX2/AVX-512/AES-NI hardware acceleration
4. **ECC Module Refactoring** - Complete ECDSA, ECDH, ECIES implementations
5. **RSA Module Refactoring** - PKCS#1 v2.2 compliant RSA-OAEP/PSS

---

## âœ¨ New Features

### Post-Quantum Cryptography (`advanced/pqc/`)

NIST-standardized lattice-based algorithms:

**ML-KEM (Kyber)**
- Kyber512 (128-bit security, Level 1)
- Kyber768 (192-bit security, Level 3)
- Kyber1024 (256-bit security, Level 5)
- Key encapsulation/decapsulation
- NTT-based polynomial arithmetic

**ML-DSA (Dilithium)**
- Dilithium2 (128-bit security)
- Dilithium3 (192-bit security)
- Dilithium5 (256-bit security)
- Digital signature generation/verification
- Fiat-Shamir with aborts

```cpp
#include <kctsb/advanced/pqc/pqc.h>

// Kyber KEM
auto kp = kctsb::pqc::kyber_keygen(KyberLevel::KYBER768);
auto [ct, ss_enc] = kctsb::pqc::kyber_encaps(kp.public_key);
auto ss_dec = kctsb::pqc::kyber_decaps(kp.secret_key, ct);

// Dilithium signatures
auto kp = kctsb::pqc::dilithium_keygen(DilithiumLevel::DILITHIUM3);
auto sig = kctsb::pqc::dilithium_sign(kp.secret_key, message, len);
bool valid = kctsb::pqc::dilithium_verify(kp.public_key, sig, message, len);
```

### Zero-Knowledge Proofs (`advanced/zk/`)

Groth16 zk-SNARK protocol on BN254 curve:

- Constraint system builder
- R1CS to QAP compilation
- Trusted setup (proving key, verification key)
- Proof generation and verification
- Example circuits (cubic, hash preimage, Merkle tree)

```cpp
#include <kctsb/advanced/zk/zkp.h>

// Build circuit: x^3 + x + 5 = y
CircuitBuilder builder;
auto x = builder.alloc_input();
auto x2 = builder.mul(x, x);
auto x3 = builder.mul(x2, x);
auto y = builder.add(x3, builder.add(x, builder.constant(5)));

// Setup and prove
Groth16 groth16;
auto [pk, vk] = groth16.setup(builder.get_constraint_system());
auto proof = groth16.prove(pk, builder.get_constraint_system());
bool valid = groth16.verify(vk, proof, public_inputs);
```

### SIMD Hardware Acceleration (`simd/`)

Runtime-detected SIMD optimizations:

- **AVX-512**: 512-bit vector operations
- **AVX2**: 256-bit vector operations
- **AES-NI**: Hardware AES encryption
- **Constant-time operations**: Side-channel resistant

```cpp
#include <kctsb/simd/simd.h>

// Check available features
if (has_feature(SIMDFeature::AVX2)) {
    // Use optimized path
}

// XOR blocks (auto-selects best instruction set)
xor_blocks(output, input1, input2, length);

// AES-NI encryption
aes128_expand_key_ni(key, round_keys);
aes128_ctr_ni(plaintext, ciphertext, length, round_keys, nonce, counter);

// ChaCha20 SIMD
chacha20_block_simd(&state, output_block);
```

### ECC Module Refactoring (`crypto/ecc/`)

Complete elliptic curve implementations:

| File | Description |
|------|-------------|
| `ecc_curve.h/cpp` | Curve definitions, point arithmetic, Montgomery ladder |
| `ecdsa.h/cpp` | RFC 6979 ECDSA with DER encoding |
| `ecdh.h/cpp` | ECDH key exchange with HKDF |
| `ecies.h/cpp` | ECIES hybrid encryption (AES-GCM) |

**Supported Curves:**
- secp256k1 (Bitcoin)
- secp256r1 / P-256 (NIST)
- secp384r1 / P-384 (NIST)
- secp521r1 / P-521 (NIST)
- SM2 (Chinese National Standard)

### RSA Module Refactoring (`crypto/rsa/`)

PKCS#1 v2.2 compliant implementations:

| File | Description |
|------|-------------|
| `rsa.h/cpp` | RSA-OAEP encryption, RSA-PSS signatures |
| `dh.h/cpp` | Diffie-Hellman key exchange (RFC 3526) |
| `dsa.h/cpp` | DSA signatures (FIPS 186-4) |

**Key Sizes:** 2048, 3072, 4096 bits (1024-bit removed for security)

---

## ğŸ“ Directory Structure Changes

High-security algorithms moved to `advanced/`:

```
include/kctsb/
â”œâ”€â”€ advanced/
â”‚   â”œâ”€â”€ pqc/
â”‚   â”‚   â””â”€â”€ pqc.h          # Kyber, Dilithium
â”‚   â”œâ”€â”€ zk/
â”‚   â”‚   â””â”€â”€ zkp.h          # Groth16 zk-SNARKs
â”‚   â”œâ”€â”€ fe/                # Functional Encryption
â”‚   â”œâ”€â”€ sss/               # Shamir Secret Sharing
â”‚   â””â”€â”€ whitebox/          # Whitebox AES
â”œâ”€â”€ crypto/
â”‚   â”œâ”€â”€ ecc/               # ECC (ECDSA, ECDH, ECIES)
â”‚   â”œâ”€â”€ rsa/               # RSA, DH, DSA
â”‚   â”œâ”€â”€ hash/              # SHA3, BLAKE2, etc.
â”‚   â””â”€â”€ sm/                # Chinese standards
â””â”€â”€ simd/
    â””â”€â”€ simd.h             # SIMD acceleration

src/
â”œâ”€â”€ advanced/
â”‚   â”œâ”€â”€ pqc/pqc.cpp
â”‚   â””â”€â”€ zk/zkp.cpp
â”œâ”€â”€ crypto/
â”‚   â”œâ”€â”€ ecc/               # 4 implementation files
â”‚   â””â”€â”€ rsa/               # 3 implementation files
â””â”€â”€ simd/simd.cpp
```

---

## ğŸ§ª New Tests

| Test File | Coverage |
|-----------|----------|
| `test_pqc.cpp` | Kyber512/768/1024, Dilithium2/3/5 |
| `test_zkp.cpp` | BN254, constraint systems, Groth16 |
| `test_simd.cpp` | XOR, ChaCha20, AES-NI, constant-time ops |

**Test Command:**
```bash
cmake --build build --target test_pqc test_zkp test_simd
ctest --test-dir build -R "pqc|zkp|simd" --output-on-failure
```

---

## ğŸ“Š Performance Benchmarks

New benchmark files added:

- `benchmarks/benchmark_ecc.cpp` - ECDSA, ECDH vs OpenSSL
- `benchmarks/benchmark_rsa.cpp` - RSA-OAEP/PSS vs OpenSSL

**Sample Results (Intel i7-12700H):**

| Operation | kctsb | OpenSSL | Speedup |
|-----------|-------|---------|---------|
| AES-256-GCM (AES-NI) | 2.1 GB/s | 2.0 GB/s | 1.05x |
| ChaCha20 (AVX2) | 3.8 GB/s | 3.5 GB/s | 1.09x |
| ECDSA Sign (P-256) | 45 Âµs | 42 Âµs | 0.93x |
| Kyber768 Keygen | 28 Âµs | N/A | - |
| Kyber768 Encaps | 35 Âµs | N/A | - |
| Dilithium3 Sign | 180 Âµs | N/A | - |

---

## ğŸ› ï¸ Build Changes

### New CMake Options

```cmake
KCTSB_ENABLE_SIMD         # Enable SIMD optimizations (default: ON)
KCTSB_ENABLE_PQC          # Enable post-quantum crypto (default: ON)
KCTSB_ENABLE_ZKP          # Enable zero-knowledge proofs (default: ON)
```

### Build Command

```powershell
cd D:\pyproject\kctsb

cmake -B build -G Ninja `
    -DCMAKE_BUILD_TYPE=Release `
    -DKCTSB_BUILD_CLI=ON `
    -DKCTSB_BUILD_TESTS=ON `
    -DKCTSB_BUILD_BENCHMARKS=ON `
    -DCMAKE_TOOLCHAIN_FILE="$env:VCPKG_ROOT\scripts\buildsystems\vcpkg.cmake"

cmake --build build --parallel
ctest --test-dir build --output-on-failure
```

---

## ğŸ”® Roadmap

### v3.3.0 (Planned)

- WebAssembly support (Emscripten)
- Rust FFI bindings
- Python bindings (pybind11)

### v4.0.0 (Planned)

- Full FIPS 140-3 compliance
- HSM integration
- Formal verification (Coq proofs)

---

## ğŸ“ Migration from v3.1.0

### Include Path Changes

```cpp
// ZKP moved to advanced/
#include <kctsb/crypto/zkp/zkp.h>      // OLD (v3.1.0)
#include <kctsb/advanced/zk/zkp.h>     // NEW (v3.2.0)

// PQC is new in v3.2.0
#include <kctsb/advanced/pqc/pqc.h>    // NEW
```

### New Namespaces

```cpp
kctsb::pqc::Kyber       // Post-quantum KEM
kctsb::pqc::Dilithium   // Post-quantum signatures
kctsb::zkp::Groth16     // Zero-knowledge proofs
kctsb::simd::*          // SIMD operations
```

---

## ğŸ™ Acknowledgments

- NTL library by Victor Shoup
- NIST PQC standardization team
- Groth16 paper by Jens Groth
- Intel Intrinsics documentation
