# kctsb v2.0.0 Release Notes

> **发布日期**: 2025-01-17
> **版本类型**: 主要版本更新 (Major Release)

---

## 🎯 概述

kctsb v2.0.0 是一次重大架构重构，将项目从 macOS/Xcode 专用构建系统迁移到跨平台 CMake 构建系统，支持 Windows、Linux 和 macOS。

## ✨ 新特性

### 跨平台支持
- **Windows**: MinGW-w64 GCC, MSVC 2019+
- **Linux**: GCC 9+, Clang 10+
- **macOS**: Clang 10+, GCC 9+

### CMake 构建系统
- 现代 CMake 3.20+ 配置
- 支持共享库 (.dll/.so/.dylib) 和静态库 (.lib/.a)
- GoogleTest 1.14.0 集成测试框架
- 可配置的可选依赖 (NTL, GMP, OpenSSL, SEAL, HElib)

### VS Code 集成
- 完整的 `.vscode` 配置
  - `tasks.json`: 构建、测试任务
  - `launch.json`: 调试配置
  - `c_cpp_properties.json`: IntelliSense 配置
  - `settings.json`: 编辑器设置

### 双语言 API
- **C API**: 纯 C 函数接口，兼容 C11
- **C++ API**: 面向对象封装，需要 C++17

### 安全随机数生成
- Windows: BCrypt API
- Unix: /dev/urandom

## 📦 新增文件结构

```
kctsb/
├── CMakeLists.txt              # 主构建配置
├── include/kctsb/              # 公共头文件
│   ├── kctsb.h                 # 主入口
│   ├── core/common.h           # 通用定义
│   ├── core/types.h            # 类型定义
│   └── crypto/aes.h            # AES API
├── src/                        # 实现
│   ├── core/export.cpp         # 核心功能
│   └── crypto/aes/aes.cpp      # AES 实现
├── tests/                      # 测试
│   └── unit/crypto/test_aes.cpp
├── examples/                   # 示例
│   └── demo/main.cpp
├── scripts/                    # 构建脚本
│   ├── build.ps1               # Windows
│   └── build.sh                # Unix
├── cmake/                      # CMake 模块
│   ├── FindNTL.cmake
│   ├── FindGMP.cmake
│   └── kctsbConfig.cmake.in
└── .vscode/                    # VS Code 配置
```

## 🔧 CMake 选项

| 选项 | 默认值 | 说明 |
|------|--------|------|
| `KCTSB_BUILD_SHARED` | ON | 构建共享库 |
| `KCTSB_BUILD_STATIC` | ON | 构建静态库 |
| `KCTSB_BUILD_TESTS` | OFF | 构建测试 |
| `KCTSB_BUILD_EXAMPLES` | OFF | 构建示例 |

## ✅ 测试结果

- **平台**: Windows 11 x64
- **编译器**: GCC 13.2.0 (MinGW-w64)
- **测试框架**: GoogleTest 1.14.0
- **测试用例**: 14 个
- **通过率**: 100%

## 🔄 迁移指南

### 从 v1.x (Xcode) 迁移

1. 删除 `kcalg.xcodeproj` 目录
2. 更新头文件包含路径:
   ```cpp
   // 旧版
   #include "opentsb/kc_sec.h"
   
   // 新版
   #include <kctsb/kctsb.h>
   ```
3. 使用 CMake 构建:
   ```bash
   cmake -B build
   cmake --build build
   ```

## ⚠️ 破坏性变更

1. **头文件路径**: 从 `opentsb/` 改为 `kctsb/`
2. **函数前缀**: 从 `kc_` 改为 `kctsb_`
3. **命名空间**: C++ 类使用 `kctsb::` 命名空间
4. **构建系统**: 从 Xcode 改为 CMake

## 📋 已知问题

1. C++ API 类（如 `kctsb::AES`）尚未完全实现
2. GCM 模式尚未实现
3. 高级算法（白盒、秘密共享等）为占位符状态

## 🔮 后续计划

- [ ] 完成所有密码算法实现
- [ ] 实现 C++ 封装类
- [ ] 添加更多测试用例
- [ ] 性能优化
- [ ] 文档生成 (Doxygen)

---

**完整变更日志**: 首次跨平台版本发布
