# kctsb v3.1.0 Release Notes

> **Release Date**: 2026-01-12 (Beijing Time, UTC+8)  
> **Version**: 3.1.0  
> **Codename**: "NTL Native"

---

## üéØ Release Highlights

This release marks a major milestone in kctsb's evolution towards becoming a modern OpenSSL replacement. The primary focus is on **removing all external dependencies** from the core library and implementing **NTL-native elliptic curve cryptography**.

### Key Changes

1. **MIRACL Dependency Removed** - ECC now uses NTL natively
2. **OpenSSL Removed from src/** - Only allowed in benchmarks
3. **Header Files Reorganized** - All headers moved to `include/`
4. **Source-Only Third-Party Installation** - No vcpkg for core dependencies
5. **Unified thirdparty/ Directory** - All dependencies in one location

---

## ‚ú® New Features

### NTL-Native Elliptic Curve Cryptography

Replaced MIRACL with pure NTL implementation:

- **Supported Curves**: secp256k1, secp256r1 (P-256), SM2
- **Implementation**: Montgomery ladder scalar multiplication
- **Security**: Constant-time operations to prevent timing attacks
- **Files**: 
  - `include/kctsb/internal/ecc_impl.h` - ECC classes and curve parameters
  - `src/crypto/ecc/ecc_ntl.cpp` - NTL ECC implementation

### Internal Implementation Headers

New internal headers for algorithm implementations:

- `include/kctsb/internal/blake2_impl.h` - BLAKE2 constants and macros
- `include/kctsb/internal/keccak_impl.h` - Keccak permutation
- `include/kctsb/internal/ecc_impl.h` - NTL ECC classes

### Third-Party Dependencies Documentation

New comprehensive installation guide:

- `docs/third-party-dependencies.md` - Source-only installation instructions
- Supports Windows (MSYS2), Linux, macOS
- All dependencies compiled to `thirdparty/` directory

---

## üîÑ Breaking Changes

### Header File Locations Changed

All header files have been moved from `src/` to `include/`:

| Old Location | New Location |
|--------------|--------------|
| `src/crypto/hash/blake2.h` | `include/kctsb/crypto/hash/blake2_impl.h` |
| `src/crypto/hash/chacha20.h` | `include/kctsb/crypto/hash/chacha20_impl.h` |
| `src/crypto/hash/Keccak.h` | `include/kctsb/crypto/hash/keccak.h` |
| `src/crypto/sm/SM3.h` | `include/kctsb/crypto/sm/sm3_impl.h` |
| `src/crypto/sm/SM4.hpp` | `include/kctsb/crypto/sm/sm4_impl.hpp` |
| `src/crypto/sm/zuc.h` | `include/kctsb/crypto/sm/zuc.h` |
| `src/crypto/ecc/eccGroup.hpp` | `include/kctsb/crypto/ecc/ecc_group.hpp` |
| `src/crypto/ecc/eccUtil.hpp` | `include/kctsb/crypto/ecc/ecc_util.hpp` |
| `src/crypto/rsa/rsaUtil.hpp` | `include/kctsb/crypto/rsa/rsa_util.hpp` |
| `src/advanced/fe/kc_fe.hpp` | `include/kctsb/advanced/fe/kc_fe.hpp` |
| `src/advanced/sss/ShamirSSS.hpp` | `include/kctsb/advanced/sss/shamir_sss.hpp` |
| `src/advanced/whitebox/whitebox_aes.h` | `include/kctsb/advanced/whitebox/whitebox_aes.h` |
| `src/advanced/zk/ffs/ffsa.h` | `include/kctsb/advanced/zk/ffsa.h` |

### MIRACL API Removed

The following MIRACL-based functions are no longer available:

- `miracl_*` functions in ECC module
- MIRACL curve types in SM2
- Replace with NTL-based `EllipticCurve` class in `ecc_impl.h`

### examples/ Directory Removed

The `examples/` directory has been removed. All example functionality is now available through the CLI tool:

```bash
# Old way (removed)
./examples/aes_demo

# New way (CLI)
./kctsb enc --aes-gcm -k <key> -i input.txt -o output.enc
```

---

## üóëÔ∏è Removed

- **MIRACL dependency** - Replaced with NTL
- **OpenSSL in src/** - Only benchmark can use OpenSSL
- **examples/ directory** - Replaced by CLI tool
- **Legacy headers in src/** - Moved to include/
- **vcpkg dependency for core** - Use thirdparty/ only

---

## üì¶ Dependency Changes

### Core Dependencies (Required)

| Dependency | Version | Installation |
|------------|---------|--------------|
| GMP | 6.3.0+ | Source to thirdparty/ |
| gf2x | 1.3.0+ | Source to thirdparty/ |
| NTL | 11.6.0+ | Source to thirdparty/ |

### Optional Dependencies

| Dependency | Version | Purpose |
|------------|---------|---------|
| SEAL | 4.1.2 | Homomorphic encryption |
| HElib | v2.3.0 | Functional encryption |

### Benchmark Only

| Dependency | Version | Source |
|------------|---------|--------|
| OpenSSL | 3.x | vcpkg |
| zlib | 1.3.1 | vcpkg |
| zstd | 1.5.7 | vcpkg |

---

## üõ†Ô∏è Build System Changes

### CMakeLists.txt Rewritten

- Optimization flags: `-O3 -march=native -mtune=native -fomit-frame-pointer`
- Preferred generator: Ninja
- thirdparty-first dependency resolution
- Separate benchmark configuration with vcpkg

### New Build Options

```cmake
KCTSB_BUILD_CLI          # Build CLI tool (kctsb.exe)
KCTSB_BUILD_TESTS        # Build GoogleTest tests
KCTSB_BUILD_BENCHMARKS   # Build benchmarks (requires OpenSSL)
KCTSB_ENABLE_SEAL        # Enable SEAL support
KCTSB_ENABLE_HELIB       # Enable HElib support
```

---

## üìä Test Results

All tests passing: **72/72 (100%)**

| Category | Tests | Status |
|----------|-------|--------|
| AES | 8 | ‚úÖ Pass |
| ChaCha20 | 4 | ‚úÖ Pass |
| Hash | 12 | ‚úÖ Pass |
| SM2/SM3/SM4 | 10 | ‚úÖ Pass |
| RSA | 6 | ‚úÖ Pass |
| ECC (NTL) | 4 | ‚úÖ Pass |
| Whitebox | 4 | ‚úÖ Pass |
| ZK (FFS) | 8 | ‚úÖ Pass |
| SSS | 4 | ‚úÖ Pass |
| Lattice | 8 | ‚úÖ Pass |
| Math | 4 | ‚úÖ Pass |

---

## üìù Migration Guide

### From v3.0.0 to v3.1.0

1. **Update include paths**:
   ```cpp
   // Old
   #include "crypto/hash/blake2.h"
   
   // New
   #include <kctsb/crypto/hash/blake2_impl.h>
   ```

2. **Replace MIRACL ECC with NTL**:
   ```cpp
   // Old (MIRACL)
   miracl_ecc_point p;
   miracl_ecc_mul(p, k);
   
   // New (NTL)
   #include <kctsb/internal/ecc_impl.h>
   kctsb::EllipticCurve curve(kctsb::CurveType::SECP256K1);
   auto result = curve.scalarMultiply(k, P);
   ```

3. **Install dependencies from source**:
   ```bash
   # Follow docs/third-party-dependencies.md
   ./configure --prefix=/path/to/kctsb/thirdparty
   make && make install
   ```

---

## üîÆ Roadmap

### v3.2.0 (Planned)

- zk-SNARKs implementation
- SIMD optimization (AVX2/AVX-512)
- WebAssembly support

### v4.0.0 (Planned)

- Post-quantum cryptography (Kyber, Dilithium)
- Hardware acceleration (AES-NI)
- Rust bindings

---

## üìö Documentation

- [Installation Guide](../third-party-dependencies.md)
- [API Reference](https://kctsb.readthedocs.io/)
- [Security Notes](../../AGENTS.md#security-notes)

---

## üôè Acknowledgments

- NTL library by Victor Shoup
- GMP library by Free Software Foundation
- SEAL by Microsoft Research
- HElib by IBM Research
